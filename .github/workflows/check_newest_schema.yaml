name: Check Newest Schema

on:
  workflow_call:

jobs:
  docker:
    - name: Checkout Dashboard Code
      uses: actions/checkout@v3

    - name: Run script that checks schemas
      run: |
        yarn
        yarn test:schema

    - name: Upload mismatched schemas
      if: failure()
      uses: actions/upload-artifact@v3
      with:
        name: mismatched-schemas
        path: ./__tests__/*.json
        retention-days: 3

    - name: Upload raw schemas
      if: failure()
      uses: actions/upload-artifact@v3
      with:
        name: mismatched-schemas
        path: ./public/*.json
        retention-days: 3
